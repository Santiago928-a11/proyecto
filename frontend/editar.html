<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Editar Mueble</title>
    <link rel="icon" href="/static/favicon.ico">
</head>
<body>
    <h1>Editar Mueble</h1>
    <form id="edit-form" method="post">
        <input type="text" id="nombre" name="nombre" placeholder="Nombre" required><br>
        <input type="text" id="descripcion" name="descripcion" placeholder="Descripción" required><br>
        <input type="number" step="0.01" id="precio" name="precio" placeholder="Precio" required><br>
        <button type="submit">Actualizar</button>
    </form>

    <!-- Mensaje dinámico para mostrar éxito o error -->
    <div id="mensaje"></div>

    <a href="index.html">Volver</a>

    <script>
        // URL base de la API FastAPI
        const API_URL = "http://localhost:8000";

        // Obtener el id del mueble desde los parámetros de la URL
        const params = new URLSearchParams(window.location.search);
        const id = params.get("id");

        const mensaje = document.getElementById("mensaje");

        // Obtener los datos actuales del producto desde la API
        fetch(`${API_URL}/muebles/${id}`)
        .then(res => res.json())
        .then(data => {
            // Rellena el formulario 
            document.getElementById("nombre").value = data.nombre;
            document.getElementById("descripcion").value = data.descripcion;
            document.getElementById("precio").value = data.precio;
        });

        // Evento al enviar el formulario de edición
        document.getElementById("edit-form").addEventListener("submit", function(e) {
            e.preventDefault(); // Evita recargar la página
            const formData = new FormData(this); // Recoge los datos del formulario

            // Enviar datos actualizados a la API 
            fetch(`${API_URL}/muebles/${id}`, {
                method: "PUT",
                body: formData
            })
            .then(response => {
                if (response.ok) {
                    // Mostrar mensaje de éxito si la actualización fue correcta
                    mensaje.textContent = "Producto Actualizado";
                    mensaje.style.color = "green";
                } else {
                    // Mostrar mensaje de error si hubo un problema
                    mensaje.textContent = "Error, no se pudo actualizar el producto";
                    mensaje.style.color = "red";
                }
            })
            .catch(() => {
                // Mostrar mensaje si no se pudo conectar al servidor
                mensaje.textContent = "Error, no se conectó al servidor";
                mensaje.style.color = "orange";
            });
        });
    </script>
</body>
</html>


